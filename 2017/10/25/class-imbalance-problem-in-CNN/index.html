<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="AceJ"><title>class imbalance problem in CNN · Ace</title><meta name="description" content="A systematic study of the class imbalance problem in convolutional neural networks
several methods：oversampling，undersampling，two-phase training，thres"><meta name="keywords"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.png" style="width:127px;"><h3 title=""><a href="/">Ace</a></h3><div class="description"><p>boom pow</p></div></div></div><ul class="social-links"></ul><div class="footer"><a target="_blank" href="/"><span>Theme by </span></a><a href="https://www.caicai.me"> CaiCai </a><span>&</span><a href="https://github.com/Ben02/hexo-theme-Anatole"> Ben</a><div class="by_farbox"><a href="https://hexo.io/zh-cn/" target="_blank">Proudly published with Hexo&#65281;</a></div></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首页</a></li><li><a href="/about">关于</a></li><li><a href="/archives">归档</a></li><li><a href="/links">友链</a></li></div><div class="information"><div class="back_btn"><li><a onclick="window.history.go(-1)" class="fa fa-chevron-left"> </a></li></div><div class="avatar"><img></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>class imbalance problem in CNN</a></h3></div><div class="post-content"><h4 id="A-systematic-study-of-the-class-imbalance-problem-in-convolutional-neural-networks"><a href="#A-systematic-study-of-the-class-imbalance-problem-in-convolutional-neural-networks" class="headerlink" title="A systematic study of the class imbalance problem in convolutional neural networks"></a>A systematic study of the class imbalance problem in convolutional neural networks</h4><ul>
<li>several methods：oversampling，undersampling，two-phase training，thresholding</li>
<li>problem：some classes have a significantly higher number of examples in the training set than other classes –<strong>class imbalance</strong> ，Eg：computer vision，medical diagnosis，fraud detection，the frequency of one class can be 1000 times less than another class</li>
<li>A new method for CNNs was introduced that trains the network in two-phases in which the network is trained on the balanced data first and then the output layers are fine-tuned</li>
</ul>
<ul>
<li><p>Methods for addressing imbalance</p>
<ul>
<li><p>Data level methods：</p>
<ul>
<li><p>Oversampling：random minority oversampling，which simply replicates randomly selected samples from minority classes</p>
</li>
<li><p>Undersampling：</p>
<p>examples are removed randomly from majority classes until all classes have the same number of examples；</p>
<p>disadvantage：discard a portion of available data</p>
</li>
</ul>
</li>
<li><p>Classifier level methods：</p>
<ul>
<li><p>Threshold：</p>
<p>adjust the decision threshold of a classifier</p>
<p>There are estimated for each class by its frequency in the imbalanced dataset before sampling is applied</p>
<p>Bayesian a posteriori probabilities</p>
<p>a given datapoint x，their output for class i，y(x)=p(i | x)=p(i)*p(x | i)/p(x)</p>
</li>
<li><p>Cost sensitive learning：</p>
<p>different cost to misclassification of examples from different classes</p>
<p>One approach is threshold moving or post scaling </p>
<p>Another adaptation of neural work is modify the learning rate such that higher cost examples contribute more to the update of weights</p>
<p>Finally we can train the network by minimizing the misclassification cost instead of standard loss function</p>
</li>
<li><p>One-class classification：</p>
<p>recognizes positive instances</p>
<p>identity function：a reconstruction error between the input and output patterns Eg：absolute error，square sum of errors，Euclidean or Mahalanobis distance</p>
<p>prove to work well for extremely high imbalance when classification problems turns info anomaly detection</p>
</li>
<li><p>Hybrid of problems：</p>
<p>Two-phase training，approached as pixel level classification</p>
<p>involve network pre-training on balanced dataset and then fine-tuning the last output layer before softmax on the original , imbalance data</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>Experiments</p>
<ul>
<li><p>Forms of imbalance：</p>
<ul>
<li>step imbalance：the number of examples is equal within minority classes and equal within majority classes but differs between the majority and minority classes</li>
<li>linear imbalance：the difference between consecutive pairs of classes is constant</li>
</ul>
</li>
<li><p>Evaluation metrics and testing</p>
<ul>
<li><p>The metric：overall accuracy</p>
</li>
<li><p>the area under the receiver operating characteristic curve(ROC AUC) </p>
<p>ROC has also been used to compare performance of classifiers trained on imbalance datasets</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li><p><strong>Conclusions</strong> ：</p>
<ul>
<li><p>The effect of class imbalance on classification performance is detrimental</p>
</li>
<li><p>The influence of imbalance on classification performance increases with the scale of a task</p>
</li>
<li><p>The impact of imbalance cannot be explained by the lower total number of training cases and depends on the distribution of examples among classes</p>
<p>​</p>
</li>
<li><p>The method that <strong>in most of the cases outperforms all others with respect to multiclass ROC AUC was oversampling</strong> </p>
</li>
<li><p>For extreme ratio of imbalance and large portion of classes being minority , undersampling performs on a par with oversampling </p>
</li>
<li><p>To achieve the best accuracy , <strong>one should apply thresholding to compensate for prior class probabilities</strong> . A <strong>combination of thresholding with baseline and oversampling is the most preferable</strong> , whereas it should not be combined with undersampling </p>
</li>
<li><p>Oversampling should be applied to the level that totally eliminates the imbalance , whereas undersampling can perform better when the imbalance is only removed to some extent</p>
</li>
<li><p>As supposed to some classical machine learning models , <strong>oversampling does not necessarily cause overfitting of convolutional neural networks</strong> </p>
</li>
</ul>
</li>
</ul>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2017-10-25</span><i class="fa fa-tag"></i><a href="/categories/project/" title="project" class="tag">project </a></div></div></div></div><div class="share"><div class="evernote"><a href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank" class="fa fa-bookmark"></a></div><div class="weibo"><a href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));" class="fa fa-weibo"></a></div><div class="twitter"><a href="http://twitter.com/home?status=,http://yoursite.com/2017/10/25/class-imbalance-problem-in-CNN/,Ace,class imbalance problem in CNN,;" class="fa fa-twitter"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a role="navigation" href="/2017/10/27/ROC-curve-AUC-Recall/" title="ROC curve,AUC&amp;Recall" class="btn">上一篇</a></li><li class="next pagbuttons"><a role="navigation" href="/2017/10/05/9-Palindrome-Number/" title="9.Palindrome Number" class="btn">下一篇</a></li></ul></div></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>